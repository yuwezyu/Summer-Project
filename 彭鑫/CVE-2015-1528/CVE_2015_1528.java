import java.io.File;
public class CVE_2015_1528{
	private static int errno;
	//exec方法等效于cmd中直接执行命令行
	private static int exec(String cmd) throws Exception{
        	Process p = Runtime.getRuntime().exec(cmd);
        	return p.waitFor();
    	}

	private static int isVulnerable(String path) throws Exception{
		//do detect
		//赋予bin文件执行权限
		exec("chmod 777 " + path + File.separator + "CVE_2015_1528");
		//执行bin获取返回值判断
		int ret = exec( path + File.separator + "CVE_2015_1528");
		switch(ret){
			case 0://漏洞不存在
				System.out.println("CVE_2015_1528 is Vulnerablitity false.\n");
            		return 255;
			case 1://漏洞存在
				System.out.println("CVE_2015_1528 is Vulnerablitity true.\n");
            		return 254;
			default:
				ret = errno;
				throw new Exception("\n[*]Detecting failed.\n");
		}
	}	
	public static void main(String args[]){
		try{
            		isVulnerable("/data/local/tmp"); 
		}catch(Exception e){
            		e.printStackTrace();
        	}
	}
}
